{"cells":[{"metadata":{"_uuid":"6d3fc5b7135a2bb736afb894333f771c768f3ea9"},"cell_type":"markdown","source":"## Summary\n* SVM C-Classification \n* `svm` function from the `e1017` R package\n\npredictor/feature\n\n*  Fares\n* Age"},{"metadata":{"_uuid":"7cfc6aa14fb6e81fa5bc0f8571b606bff34e95bd","_execution_state":"idle","trusted":true},"cell_type":"code","source":"options(echo=FALSE)\nlibrary(e1071)\nlibrary(caret)\nlibrary(tidyverse) \nlist.files(path = \"../input\")","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"d5c75c408a1f3ce3433968c8a295ba814f799250"},"cell_type":"code","source":"df_raw <- read.csv('../input/train.csv')\n#head(df_raw)\nstr(df_raw)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"ab7f2fb906cfcfb397ed5f9294f97443d1334f46"},"cell_type":"markdown","source":"## Data Prep"},{"metadata":{"_uuid":"ac5499dccc193455aaf5d1447cc2eec9c81aeb2a"},"cell_type":"markdown","source":"* `x1`: 63%\n* `x2`: 68%\n* `x3`: 77%\n* `x4`: 80%\n* `x5`: 80%"},{"metadata":{"trusted":true,"_uuid":"a5a8c52e38d2fe2fa19865898316db029af5217c","scrolled":true},"cell_type":"code","source":"df <- df_raw %>% select(PassengerId, Survived, Fare, Pclass, Age, Sex, SibSp, Parch) %>% \n    mutate(x1 = Fare / which.max(Fare),\n           x2 = ifelse(Age <= 25, Age/25., 1.-(Age - 25)/Age),  #69%\n           x3 = ifelse(Sex==\"male\", -1, 1), \n           x4 = log(1+SibSp) - log(1+Parch),\n           x5 = Parch / which.max(Parch) )\n\n#x1 = Fare / which.max(Fare)\n#x1 = Fare * (1+Pclass) / which.max(Fare * (1+Pclass)\n#x2 = log(abs(Age - 25) + 1)\n#x2 = ifelse(Age <= 25, Age/25., 1.-(Age - 25)/Age)","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"4f5a52aaebd12e7bd17e73a4c866f5c563be554a"},"cell_type":"code","source":"#head(df)\n#library(ggplot2)\n#ggplot(df, aes(x=Age, y=x2)) + geom_point()","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"55560b209ba852e57beef614b6fc462c8c7bbca0"},"cell_type":"markdown","source":"## Data Splitting\nTwo-Way data split 50:50"},{"metadata":{"trusted":true,"_uuid":"818101ba94f38fd2775354373816d73eb037c8d7"},"cell_type":"code","source":"set.seed(42)\nidx_train <- createDataPartition(df$PassengerId, p=0.5, list=FALSE, times=1)\n#idx_train\n#nrow(idx_train)\ndf_train <- df[idx_train,]\ndf_valid <- df[-idx_train,]\n#head(df_train)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"5dcc809340cc5f67be99044616265d91904c0040"},"cell_type":"markdown","source":"## Shoot First, Ask Later\n* y: uni/binary => Survived\n* x: multi/ratio or interval"},{"metadata":{"trusted":true,"_uuid":"199c4b26316614f7dca0af659f67b014d4084cbe"},"cell_type":"code","source":"model <- svm(x = df_train %>% select(x1,x2,x3,x4,x5), \n             y = as.factor(df_train$Survived), \n             scale = FALSE,\n             na.action = na.omit,\n             type = \"C-classification\",\n             kernel =\"radial\", \n             gamma = 1,\n             cost = 50)\n#summary(model)\n\nyhat <- predict(model, df_valid %>% select(x1,x2,x3,x4,x5), na.action = na.exclude)\n#length(yhat)\n\nres <- confusionMatrix(as.factor(yhat), as.factor(df_valid$Survived))\n#res\n\nacc <- unname(res$overall[1])\nacc","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"3b7e71583bfed4d03ae98d0f4cc33f454d1e3d19"},"cell_type":"markdown","source":"## Submit"},{"metadata":{"trusted":true,"_uuid":"9d196620858252bc399e3f8e09e2471b53c858e2"},"cell_type":"code","source":"df_test <- read.csv('../input/test.csv')\n\ndf_test <- df_test %>% select(PassengerId, Fare, Pclass, Age, Sex, SibSp, Parch) %>% \n    mutate(x1 = Fare / which.max(Fare),\n           x2 = ifelse(Age <= 25, Age/25., 1.-(Age - 25)/Age),  #69%\n           x3 = ifelse(Sex==\"male\", -1, 1), \n           x4 = log(1+SibSp) - log(1+Parch),\n           x5 = Parch / which.max(Parch) )\n\ndf_test[is.na(df_test)] <- 0\nhead(df_test)","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"9d196620858252bc399e3f8e09e2471b53c858e2"},"cell_type":"code","source":"yhat <- predict(model, df_test %>% select(x1,x2,x3,x4,x5))\n#length(yhat)\n\nres <- df_test %>% select(PassengerId) %>% mutate(Survived = yhat)\nhead(res)","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"984a14d931911b5712b5c0f500a4b44ccfce73b2"},"cell_type":"code","source":"write.csv(res, file = 'my_submission.csv', row.names = F)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"b0651492a50b39c64d894ea5e785f5e07f5c785d"},"cell_type":"markdown","source":"## Links\n* https://www.rdocumentation.org/packages/caret/versions/6.0-80/topics/createDataPartition\n* https://www.rdocumentation.org/packages/e1071/versions/1.7-0/topics/svm\n* https://www.rdocumentation.org/packages/caret/versions/3.45/topics/confusionMatrix\n* https://www.kaggle.com/mrisdal/exploring-survival-on-the-titanic\n"}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"3.4.2","file_extension":".r","codemirror_mode":"r"}},"nbformat":4,"nbformat_minor":1}