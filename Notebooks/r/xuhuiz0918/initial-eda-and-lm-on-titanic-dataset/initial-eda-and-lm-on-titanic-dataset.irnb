{"cells": [{"metadata": {"_uuid": "98cbc385d7e1a82ce9f9aa8574408c93b7fe8160", "_cell_guid": "f00f1331-d725-4a39-b3ba-4d073f21e857"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["# This R environment comes with all of CRAN preinstalled, as well as many other helpful packages\n", "# The environment is defined by the kaggle/rstats docker image: https://github.com/kaggle/docker-rstats\n", "# For example, here's several helpful packages to load in \n", "\n", "library(ggplot2) # Data visualization\n", "library(readr) # CSV file I/O, e.g. the read_csv function\n", "\n", "# Input data files are available in the \"../input/\" directory.\n", "# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n", "\n", "system(\"ls ../input\")\n", "\n", "# Any results you write to the current directory are saved as output."]}, {"metadata": {"_uuid": "db8890ad52defa68f4ce85d4499d506ba320d474", "_cell_guid": "64fd2dab-8fb5-4e9a-999a-cfacc7b01767"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["library(dplyr)\n", "library(ggthemes)"]}, {"metadata": {"_uuid": "9f6f5e758f1a2bea050a2648385e63913585875f", "_cell_guid": "589a7b5a-4a17-4711-978c-b1dadf7da168"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["##### Load the titanic dataset\n", "Titanic_train <- read.csv('../input/train.csv')\n", "Titanic_test <- read.csv('../input/test.csv')"]}, {"metadata": {"_uuid": "c8159a32d27a3decf2ce0a23c10aa86fdf1d04d5", "_cell_guid": "1549b7e5-ce65-4720-86d9-737b9c7a78fa"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["##### Initial EDA\n", "glimpse(Titanic_train)"]}, {"metadata": {"_uuid": "8d1a6d5abef339c483c99f4585487fbb041d7c69", "_cell_guid": "64877312-0033-4d7d-b230-b84c9d634b79"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### Transform Pclass to levels\n", "Titanic_train$Pclass <- as.factor(Titanic_train$Pclass)\n", "levels(Titanic_train$Pclass) <- c('Upper', 'Middle', 'Lower')\n", "glimpse(Titanic_train)"]}, {"metadata": {"_uuid": "66898fcc72665dd201181481ea1282bd6dd49168", "_cell_guid": "5455e474-64ec-4ed6-8544-f34ee2b14a0d"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### Transform Sex to male and female\n", "Titanic_train$Sex <- as.factor(Titanic_train$Sex)\n", "levels(Titanic_train$Sex) <- c('Female', 'Male')\n", "glimpse(Titanic_train)"]}, {"metadata": {"_uuid": "7542571881c6e7d05ce71ae4a92899d1fd7d0c3e", "_cell_guid": "6dc51144-101b-47a6-b0c1-0628507ec12a"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### 342 passengers are survived, 549 passengers are dead\n", "sum(Titanic_train$Survived == 1)\n", "sum(Titanic_train$Survived == 0)"]}, {"metadata": {"_uuid": "36f1470080c0874409dabcb476f06e51560de565", "_cell_guid": "a09fc40b-fbb1-4f0d-880a-6434b85b64bc"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### Sex distribution\n", "Sex_Distribution <- ggplot(data = Titanic_train, aes(x=Sex)) + geom_bar(fill='blue', width = 0.7) + ylab('num_of_passenger') + ggtitle('Relationship between Sex and passenger numbers')\n", "Sex_Distribution"]}, {"metadata": {"_uuid": "42f485674c0661250934ff0dc3c1ec5135571c6d", "_cell_guid": "8bb98dd9-847d-4098-8451-dbee002f0217"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### 233 Female and 109 Males are survived; 81 Female and 468 Males are dead\n", "sum(Titanic_train$Survived == 1 & Titanic_train$Sex == 'Female')\n", "sum(Titanic_train$Survived == 1 & Titanic_train$Sex == 'Male')\n", "sum(Titanic_train$Survived == 0 & Titanic_train$Sex == 'Female')\n", "sum(Titanic_train$Survived == 0 & Titanic_train$Sex == 'Male')"]}, {"metadata": {"_uuid": "a621d94b538ae90144441be684e169fca7b6f4c8", "_cell_guid": "65f4f5f2-1768-489a-bed7-77833c949bdd"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### Age distribution\n", "Titanic_train1 <- Titanic_train %>%\n", "  select(Survived, Pclass, Sex, Age) %>%\n", "  filter(Age >= 0)\n", "Age_Distribution <- ggplot() + geom_density(data = Titanic_train1, aes(x=Age), fill='blue', alpha=0.5)\n", "Age_Distribution"]}, {"metadata": {"_uuid": "8b285e7d80ee74565e841a056c67095e45474fa8", "_cell_guid": "e65fdd99-336b-4a40-a547-630dca3b94e1"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### Data Visualization for Age vs Sex vs Survived\n", "Age_Sex_Survived <- ggplot(Titanic_train1, aes(Age, fill = factor(Survived))) + geom_histogram(bins=30) + theme_few() + xlab(\"Age\") + ylab(\"Count\") + facet_grid(.~Sex)+ scale_fill_discrete(name = \"Survived\") + theme_few()+ ggtitle(\"Relationship among Age, Sex and Survived\")\n", "Age_Sex_Survived"]}, {"metadata": {"_uuid": "c4b76c2e61c2a8304c849efa9a14c1e15c479937", "_cell_guid": "cd9102bd-ee6f-4edf-bc09-c40f844fcdf5"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### 61.29% passengers younger than 10 years old survived, 36.65% passengers between 10 and 30 years old survived, 41.80% passengers between 30 and 50 years old survived, 36.49% over 50 years old survived.\n", "max(Titanic_train$Age, na.rm = TRUE)\n", "min(Titanic_train$Age, na.rm = TRUE)\n", "sum(Titanic_train1$Age < 10 & Titanic_train1$Survived == 1) / sum(Titanic_train1$Age < 10)\n", "sum(Titanic_train1$Age >= 10 & Titanic_train1$Age < 30 & Titanic_train1$Survived == 1) / sum(Titanic_train1$Age >= 10 & Titanic_train1$Age < 30)\n", "sum(Titanic_train1$Age >= 30 & Titanic_train1$Age < 50 & Titanic_train1$Survived == 1) / sum(Titanic_train1$Age >= 30 & Titanic_train1$Age < 50)\n", "sum(Titanic_train1$Age >= 50 & Titanic_train1$Survived == 1) / sum(Titanic_train1$Age >= 50)"]}, {"metadata": {"_uuid": "d85ababfcb5ea5d1afb985dda200a48012997105", "_cell_guid": "aadf6428-b70f-4e94-a946-15c305181cad"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### Pclass distribution\n", "Pclass_Distribution <- ggplot(data = Titanic_train, aes(x=Pclass)) + geom_bar(fill='blue', width = 0.7) + ylab('num_of_passenger') + ggtitle('Relationship between Pclass and passenger numbers')\n", "Pclass_Distribution"]}, {"metadata": {"_uuid": "ac69bfd4b99383486e5bf00d8481443a590242f5", "_cell_guid": "c57be8e2-d807-4013-909c-9782a331ecfb"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### Data Visualization for Pclass vs Survived\n", "Pclass_Survived <- ggplot(Titanic_train1, aes(Pclass, fill = factor(Survived))) + geom_bar() + theme_few() + xlab(\"Pclass\") + ylab(\"num_of_passengers\") + scale_fill_discrete(name = \"Survived\") + theme_few()+ ggtitle(\"Relationship between Pclass and Survived\")\n", "Pclass_Survived"]}, {"metadata": {"_uuid": "8f7c69347a04bcdfc9f7b5d29de00d1f406f269c", "_cell_guid": "db9534ca-abc8-4d86-8970-9fb6c5ef5878"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### 62.96% passengers with Upper class survived, 47.28% passengers with Middle class Survived, 24.24% passengers with Lower class Survived\n", "sum(Titanic_train$Pclass == 'Upper' & Titanic_train$Survived == 1) / sum(Titanic_train$Pclass == 'Upper')\n", "sum(Titanic_train$Pclass == 'Middle' & Titanic_train$Survived == 1) / sum(Titanic_train$Pclass == 'Middle')\n", "sum(Titanic_train$Pclass == 'Lower' & Titanic_train$Survived == 1) / sum(Titanic_train$Pclass == 'Lower')"]}, {"metadata": {"_uuid": "c7ae14c3f315598be8f54364703a869c472fddd6", "_cell_guid": "9545a234-f1d9-41b6-b78c-53a2b45dfa98"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### Family Size distribution\n", "Titanic_train$FamilySize <- ifelse(Titanic_train$SibSp + Titanic_train$Parch + 1 == 1, \"Single\", ifelse(Titanic_train$SibSp + Titanic_train$Parch + 1 < 4, \"Small\", \"Large\"))\n", "FamilySize_Distribution <- ggplot(Titanic_train, aes(FamilySize)) + geom_bar(position=\"dodge\", fill = 'blue') +  scale_x_discrete(limits=c(\"Single\", \"Small\", \"Large\")) + ylab('num_of_passenger') + ggtitle('Relationship between Family size and passenger numbers')\n", "FamilySize_Distribution"]}, {"metadata": {"_uuid": "46314d82716e7cd0559efb62ac89ef6a56615cf4", "_cell_guid": "3be2d0ce-8cab-4e55-8441-58b8fcac62b1"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### Data Visualization for Familysize vs Survived\n", "Familysize_Survived <- ggplot(Titanic_train, aes(FamilySize, fill = factor(Survived))) + geom_bar() + theme_few() + xlab(\"Familysize\") + ylab(\"num_of_passengers\") + scale_fill_discrete(name = \"Survived\") + theme_few()+ ggtitle(\"Relationship between Familysize and Survived\")\n", "Familysize_Survived"]}, {"metadata": {"_uuid": "3fbfc1985ef0249d0c055576ea060fb8d49524a8", "_cell_guid": "1e7c049f-23cf-4e4b-a92b-6834304cd239"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["### 30.35% passengers with Single family size survived, 56.27% passengers with Small family size survived, 34.07% passengers with Large family size survived\n", "sum(Titanic_train$FamilySize == 'Single' & Titanic_train$Survived == 1) / sum(Titanic_train$FamilySize == 'Single')\n", "sum(Titanic_train$FamilySize == 'Small' & Titanic_train$Survived == 1) / sum(Titanic_train$FamilySize == 'Small')\n", "sum(Titanic_train$FamilySize == 'Large' & Titanic_train$Survived == 1) / sum(Titanic_train$FamilySize == 'Large')"]}, {"metadata": {"_uuid": "9e66fc3d8af68cac6d3dd0a89243309a7d76818d", "scrolled": true, "_cell_guid": "4ba52a0d-7ca0-45a8-9cc0-30ec9535c377"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["##### Linear Model: Survived = 1.014245 - 0.489949*SexMale - 0.006252*Age - 0.209941*PclassMiddle - 0.400391*PclassLower + 0.148970*FamilySizeSingle + 0.166486*FamilySizeSmall\n", "Titanic_train_model <- Titanic_train %>%\n", "  filter(Age >= 0) %>%\n", "  select(Sex, Age, Pclass, FamilySize, Survived)\n", "Titanic_model <- lm(Survived ~ Sex + Age + Pclass + FamilySize, data = Titanic_train_model)\n", "summary(Titanic_model)"]}, {"metadata": {"_uuid": "6a73f3251ec61a84601cfd5ad2dd53f3498d6a35", "_cell_guid": "9402e183-8deb-4782-b61a-329162153309"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["Titanic_test$FamilySize <- ifelse(Titanic_test$SibSp + Titanic_test$Parch + 1 == 1, \"Single\", ifelse(Titanic_test$SibSp + Titanic_test$Parch + 1 < 4, \"Small\", \"Large\"))\n", "Titanic_test$Pclass <- as.factor(Titanic_test$Pclass)\n", "levels(Titanic_test$Pclass) <- c('Upper', 'Middle', 'Lower')\n", "Titanic_test$Sex <- as.factor(Titanic_test$Sex)\n", "levels(Titanic_test$Sex) <- c('Female', 'Male')"]}, {"metadata": {"_uuid": "3ecb43d883c125fd06dcd08775d9db2cd2f866f7", "_cell_guid": "fc924f4c-07d7-4d9d-9017-9469a660129a"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["submission <- Titanic_test %>%\n", "mutate(Survived = round(predict(Titanic_model, Titanic_test))) %>%\n", "select(PassengerId, Survived)\n", "submission[is.na(submission)] <- 0\n", "submission"]}, {"metadata": {"_uuid": "45e06fc3437292b5aa9eb20687af323655c5a19b", "_cell_guid": "d109e1de-5f00-4397-88bf-d11ebe8c7d57"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": ["write.csv(submission, file = 'submission.csv', row.names = F)"]}, {"metadata": {"_uuid": "75c8ca792728eae8fccbcd81bc9bc32655c7f60b", "_cell_guid": "74d40a74-dd4f-4f15-be29-05ee0b88965a"}, "outputs": [], "execution_count": null, "cell_type": "code", "source": []}], "nbformat": 4, "metadata": {"kernelspec": {"display_name": "R", "language": "R", "name": "ir"}, "language_info": {"name": "R", "codemirror_mode": "r", "version": "3.4.2", "pygments_lexer": "r", "file_extension": ".r", "mimetype": "text/x-r-source"}}, "nbformat_minor": 1}