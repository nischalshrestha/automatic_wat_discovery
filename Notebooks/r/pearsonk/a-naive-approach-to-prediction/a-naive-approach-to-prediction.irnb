{"cells":[{"metadata":{"_execution_state":"idle","_uuid":"f1da60ca48f5d4ff84e0f4e7c0cba3053d864f0e","trusted":true,"_cell_guid":"f6cc4909-b585-4a44-98b5-1ca69388655d"},"cell_type":"code","source":"library(dplyr)\nlibrary(e1071)\n\n###Reading the data###\ntrain=read.csv(\"../input/train.csv\")\n\n###A comprehensive view of the data structure####\nglimpse(train)","execution_count":22,"outputs":[]},{"metadata":{"_uuid":"0e987d6acc169f09def694fec5f42ed30203bb5f","trusted":true,"_cell_guid":"b638d0d0-b5a4-4b52-b0dc-004681fae9ec"},"cell_type":"code","source":"###A glimpse of the data set###\n\n###The First 6 Passengers###\nhead(train)\n###The Last 6 Passengers###\ntail(train)","execution_count":3,"outputs":[]},{"metadata":{"_uuid":"87bd3445b37ca61d42ac3a154b88ae0786cb11f9","trusted":true,"_cell_guid":"7cdac4b0-188c-454c-a162-f9f3ad233ae3"},"cell_type":"code","source":"###Relabelling some categorical variables\n####Survived\ntrain$Survived[train$Survived==0]=\"Did not survive\"\ntrain$Survived[train$Survived==1]=\"Survived\"\n####Pclass\ntrain$Pclass[train$Pclass==3]=\"Lower\"\ntrain$Pclass[train$Pclass==2]=\"Middle\"\ntrain$Pclass[train$Pclass==1]=\"Upper\"\n####Embarked\ntrain$Embarked=as.character(train$Embarked)\ntrain$Embarked[train$Embarked==\"C\"]=\"Chebourg\"\ntrain$Embarked[train$Embarked==\"Q\"]=\"Queenstown\"\ntrain$Embarked[train$Embarked==\"S\"]=\"Southampton\"\ntrain$Embarked[train$Embarked==\"\"]=\"Already on board\"\ntrain$Embarked=as.factor(train$Embarked)","execution_count":10,"outputs":[]},{"metadata":{"_uuid":"f82f2fdd03045f25b9748a62f12bfd1283501ada","_cell_guid":"0cc86224-3511-43e4-9a33-560994f850ff"},"cell_type":"markdown","source":"2. Descriptive Insight into the data"},{"metadata":{"_uuid":"c4f866e5c949b4baa4768d4d088da3d97d32350c","trusted":true,"_cell_guid":"800818de-e423-498d-95e2-d6f7577e2256"},"cell_type":"code","source":"###Some meaningful descriptive information about the data###\n\n###Number of Survivals and Non-survivals####\nprint(\"Number of survivals and non-survivals\")\nout1=matrix(table(train$Survived))\nrownames(out1)=unique(train$Survived)\ncolnames(out1)=c(\"Number of passengers\")\nout1\n\n###Number of survivals and non-survivals by Gender###\nprint(\"Number of survivals and non-survivals by Gender\")\nout2=table(train$Survived,train$Sex)\nout2\n\n###Number of survivals and non-survivals by Class###\nprint(\"Number of survivals and non-survivals by Class\")\nout3=table(train$Survived,train$Pclass)\nout3\n\n####Number of survivals and non-survivals by Port of Embarkation####\nprint(\"Number of survivals and non-survivals by Port of Embarkation\")\nout4=table(train$Survived,train$Embarked)\nout4\n\n####Number of survivals and non-survivals by Age group####\nprint(\"Number of survivals and non-survivals by Age group\")\nag=case_when(train$Age<=10 ~ \"<= 10yrs\",\n            between(train$Age,10,20) ~ \"Btwn10and20yrs\",\n            between(train$Age,20,30) ~ \"Btwn20and30yrs\",\n            between(train$Age,30,40) ~ \"Btwn30and40yrs\",\n            between(train$Age,40,50) ~ \"Btwn40and50yrs\",\n             train$Age>50 ~ \"z> 50yrs\")\nagegrp=as.factor(ag)\ntrain1=data.frame(train,agegrp)\nout5=matrix(table(train1$Survived,train1$agegrp),nrow=2)\ncolnames(out5)=levels(train1$agegrp)\nrownames(out5)=unique(train1$Survived)\nout5","execution_count":11,"outputs":[]},{"metadata":{"_uuid":"a93e0b2bf05f05b9c85d9a44bdb0417ba8a5d076","_cell_guid":"e79d5e74-f18a-4f2d-bb7b-52a65202bce9"},"cell_type":"markdown","source":"1.  A Visual look into the data "},{"metadata":{"_uuid":"8c49ff774896525ba9dac06852d7358199905c25","trusted":true,"_cell_guid":"668e182a-0c12-4def-8ab3-8edf129b8056"},"cell_type":"code","source":"###Frequency plot of survivals and non-survivals\nbarplot(table(train$Survived),col=c(\"red\",\"blue\"),main=\"Frequency plot of Survivals\",xlab=\"Survival\",ylab=\"Number of passengers\")\n\n###Frequency plot of survivals and non-survivals by Gender\nbarplot(table(train$Survived,train$Sex),col=c(\"red\",\"blue\"),beside=TRUE,main=\"Frequency plot of Survivals by Gender\",xlab=\"Gender\",ylab=\"Number of passengers\")\n\n###Frequency plot of survivals and non-survivals by Class\nbarplot(table(train$Survived,train$Pclass),col=c(\"red\",\"blue\"),beside=TRUE, main=\"Frequency plot of Survivals by Class\",xlab=\"Class\",ylab=\"Number of passengers\")\n\n###Frequency plot of survivals and non-survivals by Port of Embarkation\nbarplot(table(train$Survived,train$Embarked),col=c(\"red\",\"blue\"), beside=TRUE, main=\"Frequency plot of Survivals by PortofEmbarkation\",xlab=\"Embarkation\",ylab=\"Number of passengers\")\n\n####Frequency plot of survivals and non-survivals by Age group\nbarplot(table(train$Survived,train1$agegrp),col=c(\"red\",\"blue\"), beside=TRUE, main=\"Frequency plot of Survivals by Age Group\",xlab=\"Age Group\",ylab=\"Number of passengers\")","execution_count":12,"outputs":[]},{"metadata":{"_uuid":"de8e6e783022df63a9a01943fb86a6970c374f44","trusted":true,"_cell_guid":"766e0b38-2b2f-4475-b157-a83c0ad46d01"},"cell_type":"code","source":"###Data Cleaning and Preparation###\ndt=data.frame(as.factor(train$Survived),train[,-2])\ndt1=dt[,-2] ##Removing Passenger ID###\ndt2=dt1[,-3] ###Removing Passenger Name###\ndt3=dt2[,-7] ####Removing Ticket#####\ntrain2=dt3[,-8] ####Removing Cabin####\nvarnames=names(train2)\nvarnames=c(\"Survived\",varnames[-1])\ncolnames(train2)=varnames\nprint(\"The following are the predictor variables used:\")\nnames(train2[,2:ncol(train2)])","execution_count":13,"outputs":[]},{"metadata":{"_uuid":"2823fe60698aaf5f3b6e4b0057ea0d0a6ea8b277","_cell_guid":"926808c9-fc11-4291-9ec1-b3fdd086101d"},"cell_type":"markdown","source":"1. Model Fitting and Evaluation"},{"metadata":{"_uuid":"cea8a39921f2d61fd39b7070aee1f4936d5d9cd1","trusted":true,"_cell_guid":"dd890181-1120-48c5-b34c-8df9f584eea4"},"cell_type":"code","source":"####Fitting the Model####\nn=nrow(train2)\nmodel=naiveBayes(Survived~.,data=train2)\nPredicted=predict(model,train2[,-1])\nprint(\"Fitted model results\")\nhead(data.frame(Predicted,train))\n###Model Evaluation####\nCM=matrix(0,nrow=2,ncol=2)\nTP=0\nTN=0\nFN=0\nFP=0\nfor(i in (1:n)){\n  if(Predicted[i]==\"Survived\" & train2$Survived[i]==\"Survived\"){\n    TP=TP+1\n  }\n  if(Predicted[i]==\"Did not survive\" & train2$Survived[i]==\"Did not survive\"){\n    TN=TN+1\n  }\n  if(Predicted[i]==\"Did not survive\" & train2$Survived[i]==\"Survived\"){\n    FP=FP+1\n  }\n  if(Predicted[i]==\"Survived\" & train2$Survived[i]==\"Did not survive\"){\n    FN=FN+1\n  }\n}\nP=TP+TN+FP+FN\nCM[1,1]=TP\nCM[1,2]=FP\nCM[2,1]=FN\nCM[2,2]=TN\ncolnames(CM)=c(\"Actual Positive{1}\",\"Actual Negative{0}\")\nrownames(CM)=c(\"Predicted Positive{1}\",\"Predicted Negative{0}\")\nAcc=(TP+TN)/P\nMisr=(FP+FN)/P\nprint(\"Confusion Matrix\")\nCM\nprint(\"Accuracy and Misclassification rate\")\ndata.frame(Acc,Misr)","execution_count":20,"outputs":[]},{"metadata":{"_uuid":"ad620b65cf06ef6e40ef6afc35b828cd813656d2","_cell_guid":"aa54a95e-16cb-41f4-be49-1244937467ae"},"cell_type":"markdown","source":"Prediction"},{"metadata":{"_uuid":"e6413bfdf375910cb9a6ef51f3002f41fa125c3f","trusted":true,"_cell_guid":"10499a41-af8e-4fec-b059-fc2c9653f1d1"},"cell_type":"code","source":"###Reading the test data####\ndl=read.csv(\"../input/test.csv\")\ndl1=dl[,-1] ##Removing Passenger ID###\ndl2=dl1[,-2] ###Removing Passenger Name###\ndl3=dl2[,-6] ####Removing Ticket#####\ntest=dl3[,-7] ####Removing Cabin####\n####Naive Bayes prediction###\n####Pclass\ntest$Pclass[test$Pclass==3]=\"Lower\"\ntest$Pclass[test$Pclass==2]=\"Middle\"\ntest$Pclass[test$Pclass==1]=\"Upper\"\n####Embarked\ntest$Embarked=as.character(test$Embarked)\ntest$Embarked[test$Embarked==\"C\"]=\"Chebourg\"\ntest$Embarked[test$Embarked==\"Q\"]=\"Queenstown\"\ntest$Embarked[test$Embarked==\"S\"]=\"Southampton\"\ntest$Embarked[test$Embarked==\"\"]=\"Already on board\"\ntest$Embarked=as.factor(test$Embarked)\nyhat=predict(model,test)\npred1=data.frame(yhat,dl)\nprint(\"Prediction using the test dataset\")\nhead(pred1,n=20)","execution_count":23,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"3.4.2","file_extension":".r","codemirror_mode":"r"}},"nbformat":4,"nbformat_minor":1}