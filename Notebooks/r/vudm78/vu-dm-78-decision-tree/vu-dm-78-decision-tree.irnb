{"cells":[{"metadata":{"_uuid":"1a400d1d03c68340fb3c024bdd65cc1e98df4a18"},"cell_type":"markdown","source":"Load librabries and import data"},{"metadata":{"_kg_hide-output":true,"_kg_hide-input":false,"_uuid":"ceb195f29672b8ac544d96da12aa36911dd55948","_cell_guid":"e25f5373-0446-4ac9-bfa3-2150a93e1904","_execution_state":"idle","trusted":false},"cell_type":"code","source":"library(dplyr)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(rpart)\nlibrary(rpart.plot)\nlibrary(tidyr)\n\ntest <- read.csv2(\"../input/test.csv\",\n                  sep = \",\")\ntrain <- read.csv2(\"../input/train.csv\",\n                   sep = \",\")\ngender_submission <- read.csv2(\"../input/gender_submission.csv\",\n                               sep = \",\")\n","execution_count":17,"outputs":[]},{"metadata":{"_uuid":"2c8e30ee0043362754dd50e4590ac556ddb896dc"},"cell_type":"markdown","source":"Adjust the data\nExtract the title from Name\nRemove \\ from Embarked\nExtract Cabin character\nRound estimated ages, and fractional ages to zero\nSet Fare as double\nDelete the variables PassengerID, Name and Ticket\n"},{"metadata":{"_kg_hide-output":true,"trusted":false,"_uuid":"d5fd9a6a78ab7cd0c2a34a8480a520e1c465ead8"},"cell_type":"code","source":"colnames(train)[12] <- \"Embarked\"\ntrain <- train %>%\n  mutate(Survived = as.character(Survived)) %>%\n  mutate(Title = str_split_fixed(str_split_fixed(Name, \", \", 2)[,2], \" \", 2)[,1]) %>%\n  mutate(Embarked = toupper(substr(Embarked, 1, 1))) %>%\n  mutate(Cabin = toupper(substr(Cabin, 1, 1))) %>%\n  mutate(Age = floor(as.double(as.character(Age)))) %>%\n  mutate(Fare = as.double(as.character(Fare))) %>%\n  select(-PassengerId, -Name, -Ticket)\n\ncolnames(test)[11] <- \"Embarked\"\ntest <- test %>%\n  mutate(Title = str_split_fixed(str_split_fixed(Name, \", \", 2)[,2], \" \", 2)[,1]) %>%\n  mutate(Embarked = toupper(substr(Embarked, 1, 1))) %>%\n  mutate(Cabin = toupper(substr(Cabin, 1, 1))) %>%\n  mutate(Age = floor(as.double(as.character(Age)))) %>%\n  mutate(Fare = as.double(as.character(Fare))) %>%\n  merge(gender_submission) %>%\n  filter(Title != \"Dona.\") %>%\n  select(-PassengerId, -Name, -Ticket)","execution_count":18,"outputs":[]},{"metadata":{"_uuid":"8b942500c01a55bbdd52fa8b4947dff3f43d82c9"},"cell_type":"markdown","source":"Visualisation of the Age\n\nOne would expect that children and people older than 65 are less likely to survive the Titanic due to their physical state.  This graph is based on 714 passengers. There is variation in the age density of the passengers that survived and the ones that did not. The hypothesis seems partly right, people older than 75 die more frequently. But children younger than 12 survive more often.  "},{"metadata":{"trusted":false,"_uuid":"2f6d8dc2a149c157ed3a026d40c9fe98a2e9d24b"},"cell_type":"code","source":"df <- train %>% \n  filter(Age != \"\") %>% \n  mutate(Survived = replace(Survived, Survived == 0, \"No\")) %>%\n  mutate(Survived = replace(Survived, Survived == 1, \"Yes\"))\n\nggplot(df, aes(Age, color = Survived, fill = Survived)) + \n  geom_density(alpha = 0.1) + \n  theme_minimal() +\n  xlab(\"Age\") +\n  ylab(\"Density\")","execution_count":19,"outputs":[]},{"metadata":{"_uuid":"06ca604523a6c8bd51c1d181014a9c3c871e22ad"},"cell_type":"markdown","source":"Visualisation of the Fare\n\nAnother assumption one can make about the fare. Passengers with a higher ticket price might be more likely to survive. Because higher priced tickets are often closer to the deck. The graph is based on all 891 passengers, although ticket prices of zero are not likely. Passengers that paid more than 17 pounds are more likely to survive. "},{"metadata":{"_kg_hide-output":false,"trusted":false,"_uuid":"49bff90f1cb37e817f5aa05c9e2fe2ab4a35aca8"},"cell_type":"code","source":"df <- train %>% \n  filter(Fare != \"\") %>% \n  mutate(Survived = replace(Survived, Survived == 0, \"No\")) %>%\n  mutate(Survived = replace(Survived, Survived == 1, \"Yes\"))\n\nggplot(df, aes(Fare, color = Survived, fill = Survived)) + \n  geom_density(alpha = 0.1) + \n  theme_minimal() +\n  xlab(\"Fare\") +\n  ylab(\"Density\")\n","execution_count":27,"outputs":[]},{"metadata":{"_uuid":"2b635994bb0f22cd48ffa75495c9dc660a2a51a4"},"cell_type":"markdown","source":"Build and evaluate decision tree\n\nSince the variable Sex is enclosed in the Title variable is it reasonable that Sex is left out. So we expect an accuracy above 79% (all female classified als survived and all male as died). Passengers that were in class 3 and were woman had nearly a fifty fifty chance to survive. \nAs shown in the Age density graph, passangers older then 16 had more chance to surviv"},{"metadata":{"trusted":false,"_uuid":"1e3410927db385984e525217d938e4b538da50b1"},"cell_type":"code","source":"model1 <- rpart(Survived ~ ., data = train, method = \"class\")\nrpart.plot(model1)\nprediction1 <- round(predict(model1, train, method = \"class\"))\nprediction1 <- as.data.frame(prediction1) %>%\n  mutate(Predicted_Survived = if_else(`0` == 0, 1, 0)) %>%\n  select(Predicted_Survived) %>%\n  mutate(Real_Survived = train$Survived)\ntable(prediction1)\n\nprint(paste(\"Accuracy is \", round((table(prediction1)[1,1] + table(prediction1)[2,2])/sum(table(prediction1))*100), \"%\"))","execution_count":25,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"3.4.2","file_extension":".r","codemirror_mode":"r"}},"nbformat":4,"nbformat_minor":1}