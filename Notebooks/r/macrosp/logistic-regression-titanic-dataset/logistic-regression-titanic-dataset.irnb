{"cells":[{"metadata":{"_kg_hide-input":false,"_uuid":"3d7e3fb6fbfd0974d6b502f4ccbc9b8143d9ab6a","trusted":false,"_cell_guid":"a6c72be3-bd08-49e3-aa1e-4980a66b64a4","_kg_hide-output":false},"cell_type":"code","source":"# Name: Matheus Brizolla\n# Date: 04/22/18\n# Dataset: Titanic\n\n# Loading our library / Carregando nossa biblioteca\nlibrary(MASS)\n\n# Loading our train data and test data  / Carregando nossas bases de treino e teste\ntest <- read.csv(\"../input/test.csv\")\ntrain <- read.csv(\"../input/train.csv\")","execution_count":null,"outputs":[]},{"metadata":{"_kg_hide-input":false,"_kg_hide-output":false,"_uuid":"760d27c280ee73b694c6e135ee90da6423295a58","_cell_guid":"eb77382b-8465-4b6f-a606-c3a5c47f213d"},"cell_type":"markdown","source":"<h2>Exploratory analysis<h2>\n\nUnderstading what our data are saying."},{"metadata":{"_kg_hide-input":false,"_uuid":"5acceef1154b1eede3b76c0512ce44c0a55062d5","trusted":false,"_cell_guid":"e7f72938-bae2-48ce-a4d3-dd22277d74e2","_kg_hide-output":false},"cell_type":"code","source":"# Checking if our data is ok / Verifica se os dados estão de acordo com o esperado\nhead (train)","execution_count":null,"outputs":[]},{"metadata":{"_kg_hide-input":false,"_uuid":"0a555e8b42a2d6f1548c5a833f2546ebe030bf65","trusted":false,"_cell_guid":"34e18f1d-42a1-4cfa-9e23-6d85b5405246"},"cell_type":"code","source":"# Checking the type of each column / Verifica o tipo das colunas\nstr(train)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"f1f7db083ac9f0314e7811d4e4355ab4e31d2e40","trusted":false,"_cell_guid":"3d39dcf9-e812-43ee-892f-ccddbdc85df8","_kg_hide-output":false},"cell_type":"code","source":"# Summarize our data / Traz as principais informações para a nossa primeira análise\nsummary (train)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"20f674a67088238968fd6ba22cd39afda1ce29f1","trusted":false,"_cell_guid":"31df422b-d652-4cdf-be62-e0df2fc5ae06"},"cell_type":"code","source":"# Telling to our model what variables are factors / Avisa ao nosso modelo quais são as variáveis categóricas\ntrain$Pclass <- factor(train$Pclass)\ntrain$Survived <- factor(train$Survived)\n\ntest$Pclass <- factor(test$Pclass)","execution_count":null,"outputs":[]},{"metadata":{"_kg_hide-input":false,"_uuid":"7817ef65dd3e17b9a3c74778325185f40cabe73f","trusted":false,"_cell_guid":"028e08b4-4a18-43a7-b8f8-fd45af753fd4"},"cell_type":"code","source":"# Checking if our train data have missing values / Verificando se há algum campo em vazio\nNAvalue_train <- sapply(train, function(x) sum(is.na(x)))\nMissingNA_train <- data.frame(index = names(train), Missing_Values = NAvalue_train)\nMissingNA_train[MissingNA_train$Missing_Values > 0,]\n                  \n# Checking if our test data have missing values / Verificando se há algum campo em vazio\nNAvalue_test <- sapply(test, function(x) sum(is.na(x)))\nMissingNA_test <- data.frame(index = names(test), Missing_Values = NAvalue_test)\nMissingNA_test[MissingNA_test$Missing_Values > 0,]","execution_count":null,"outputs":[]},{"metadata":{"_kg_hide-input":false,"_uuid":"e15648b400231a7fd4ee2c36cfe101367148a5e5","trusted":false,"_cell_guid":"7ceb6b1e-93ef-4dd0-b553-584d55a371bf"},"cell_type":"code","source":"# Handling our missing values / Cuidando dos valores NA\ntrain$Age [is.na(train$Age)] <- median(train$Age, na.rm=TRUE)\n\ntest$Fare [is.na(test$Fare)] <- median(test$Fare, na.rm=TRUE)\ntest$Age [is.na(test$Age)] <- median(train$Age, na.rm=TRUE)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"acf1e84f792eada4f93e718e6315ecad521dc449","_cell_guid":"48304f28-8d19-4a41-a1b2-304498ea749a"},"cell_type":"markdown","source":"<h2>Logistic Regression</h2>\n\nLet's run our logistic model."},{"metadata":{"_kg_hide-input":false,"_uuid":"1006c752e9072694dbe84f5f47cac88e065a72ee","trusted":false,"_cell_guid":"1b6e88f4-22ba-479c-b08b-cd48b9220c3a"},"cell_type":"code","source":"# Logistic Regression / Regressão logística\nrl <- glm(Survived ~ Sex + Pclass + Age + SibSp, data = train, family = \"binomial\")","execution_count":null,"outputs":[]},{"metadata":{"_kg_hide-input":false,"_uuid":"4d1eadbc1ca100521670eab0210d8f64d40097cb","trusted":false,"_cell_guid":"b80c8a9c-038b-4dba-b7e4-e90e57302411"},"cell_type":"code","source":"# Summarizing our model / Verificando nosso modelo\nsummary (rl)","execution_count":null,"outputs":[]},{"metadata":{"_kg_hide-input":false,"_uuid":"f67ee61f890131a5bf9b7180117e5363a0f3ccdc","trusted":false,"_cell_guid":"efe0fa76-070d-48c4-b353-8e05878d9d97"},"cell_type":"code","source":"# Predicting / Predição\nprevisto <- ifelse(predict(rl, newdata = train, type = \"response\")>0.5,1,0)\n\n# Setting our result in a new column / Colocando o nosso resultado em uma nova coluna\ntrain$Previsao <- previsto\n\n# Visualizing our prediction / Vizualizando nossa predição\ntb <- table(train$Previsao >= 0.5, train$Survived)\ntb\ncat(\"Accuracy: \", (tb[1,1] + tb[2,2])/ nrow(train)*100, \"/ Taxa de acerto:\", (tb[1,1] + tb[2,2])/ nrow(train)*100)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"a5cd39abfb27bd3cabb0e613bc8b77a2235363fe","trusted":false,"_cell_guid":"67722ca7-cd4b-40c6-9bcc-0ee9ca2f79c6","_kg_hide-input":false},"cell_type":"code","source":"# Now we are doing the same to test data / Repetindo as ações mas na base de treino\npredictTest <- predict(rl, newdata = test, type = \"response\")\ntest$Survived <- as.numeric(predictTest >= 0.5)\ntable(test$Survived)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"cbb4a282f0d84dce18cf43e21f87b266044c22d0","trusted":false,"_cell_guid":"a4f73b63-4cdf-4ab7-8fc0-f882c7170129"},"cell_type":"code","source":"# Creating the file to submit / Criando o arquivo para envio\nsubm<-data.frame(test$PassengerId)\nnames(subm)[1]<-\"PassengerId\"\n\nsubm$Survived<-test$Survived\n\nwrite.csv(subm, file = \"titanic_logr_submission.csv\", row.names=FALSE)","execution_count":null,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"3.4.2","file_extension":".r","codemirror_mode":"r"}},"nbformat":4,"nbformat_minor":1}