{"metadata": {"language_info": {"version": "3.4.2", "pygments_lexer": "r", "file_extension": ".r", "name": "R", "mimetype": "text/x-r-source", "codemirror_mode": "r"}, "kernelspec": {"language": "R", "name": "ir", "display_name": "R"}}, "cells": [{"metadata": {"_cell_guid": "4debd260-ad08-4059-8fc4-b534e869c43f", "_uuid": "06b42ac9bb956e993500b93f259ad7fb1e4d5a56"}, "cell_type": "markdown", "source": ["**<h2>Abaixo o c\u00f3digo feito em R para a predi\u00e7\u00e3o de sobreviventes no naufr\u00e1gio do Titanic</h2>**\n", "Autor: <b>Jeferson Padilha</b>"]}, {"metadata": {"_cell_guid": "10203944-bdf7-4135-bdd5-d91a45df89f1", "_uuid": "d978d39ccfa88296e60d193c1892bdaf10622290"}, "cell_type": "markdown", "source": ["**<h2>Carregando as Bibliotecas</h2>**\n", "Vamos come\u00e7ar carregando as bibliotecas que utilizaremos durante a an\u00e1lise"]}, {"metadata": {"_cell_guid": "0684d729-49d3-474c-a9b2-b7cbf1def8e8", "_kg_hide-output": true, "_kg_hide-input": false, "_uuid": "c4b4d737c58dc460927b40328b8af538d825e6d7"}, "cell_type": "code", "outputs": [], "execution_count": null, "source": ["library(ggplot2) # Visualiza\u00e7\u00e3o de Dados\n", "library(readr) # Leitura de arquivo\n", "library('randomForest') #predi\u00e7\u00e3o de sobreviventes"]}, {"metadata": {"_cell_guid": "5a01f8f3-eb99-4a15-8d3c-1618e0d13562", "_uuid": "656072016ae1ab1347d5e0a6d7e7d8454e7020a5"}, "cell_type": "markdown", "source": ["**<h2>Carregando os Arquivos</h2>**\n", "Tamb\u00e9m \u00e9 necess\u00e1rio carregar os arquivos de Treino e Teste\n", "obs: \u00c9 importante utilizar o atributo **stringsAsFactor** = FALSE ou F. Por padr\u00e3o, o R tenta converter vari\u00e1veis em fator, e isto poder\u00e1 inflenciar no resultado da predi\u00e7\u00e3o. Faremos esta convers\u00e3o no decorrer da an\u00e1lise."]}, {"metadata": {"_cell_guid": "6c77fac0-ef8e-4256-9e12-2b82104ed1e0", "_uuid": "5287317cd4ab083ac0cb59d51e0ea0c6539242fa"}, "cell_type": "code", "outputs": [], "execution_count": null, "source": ["titanic.train <- read.csv(\"../input/train.csv\", stringsAsFactor=F, header = T) #Arquivo de Treino\n", "titanic.test <- read.csv(\"../input/test.csv\", stringsAsFactor=F, header = T) #Arquivo de Teste"]}, {"metadata": {"_cell_guid": "cab719a9-bdc7-4999-9434-ad47b261b34a", "_uuid": "401bcd30132efe220773213eb5800a52206fb101"}, "cell_type": "markdown", "source": ["**<h2>Explorando os Dados</h2>**\n", "Primeiro, vamos conhecer as colunas do dataset. Tente usar os comandos str(titanic.train), head(titanic.train,10) ou at\u00e9 mesmo summary(titanic.train). Este \u00faltimo traz informa\u00e7\u00f5es relevantes (Ex. Valor M\u00ednimo, M\u00e1ximo, Mediana e Quartis). \n", "Para conhecer os nomes das vari\u00e1veis, a fun\u00e7\u00e3o str() j\u00e1 \u00e9 suficiente."]}, {"metadata": {"_cell_guid": "bd489215-7866-43ea-9034-ee91c32c988c", "_uuid": "bd9ba8b45af150191dcdd45b0ae51874332938c4", "scrolled": true}, "cell_type": "code", "outputs": [], "execution_count": null, "source": ["str(titanic.train)"]}, {"metadata": {"_cell_guid": "03b0750c-1c70-469f-a70a-d34e4ded1805", "_uuid": "b89252de05063bab1ebeb42fede8b486fe2e401e"}, "cell_type": "markdown", "source": ["Vamos verificar a existencia de valores nulos com o comando abaixo."]}, {"metadata": {"_cell_guid": "ac3e36da-840e-42e0-8a76-37e8fa5ad596", "_uuid": "37745ec2698004108cedfe0c58d1e3841d2dffe9"}, "cell_type": "code", "outputs": [], "execution_count": null, "source": ["table(is.na(titanic.train))\n", "table(is.na(titanic.test))"]}, {"metadata": {"_cell_guid": "513ad6d9-952f-4f0b-bff8-404ecfd5940f", "_uuid": "3f41858b941079187bdb24b8c9b3459af0adaf79"}, "cell_type": "markdown", "source": ["Existem 177 observa\u00e7\u00f5es que necessitam ser tratadas no dataset de treino e 87 no dataset de teste. Vamos juntar os dataset's e trat\u00e1-las uma \u00fanica vez. Antes, devemos seguir algumas tarefas:\n", "\n", "Primeiro, verificar o numero de colunas em cada dataset:"]}, {"metadata": {}, "cell_type": "code", "outputs": [], "execution_count": null, "source": ["ncol(titanic.train)\n", "ncol(titanic.test)"]}, {"metadata": {}, "cell_type": "markdown", "source": ["Note que h\u00e1 diferen\u00e7as, certamente \u00e9 a aus\u00eancia da coluna Survived no dataset de teste. Neste caso, vamos cri\u00e1-la e atribuir um valor nulo."]}, {"metadata": {}, "cell_type": "code", "outputs": [], "execution_count": null, "source": ["titanic.test$Survived <- NA"]}, {"metadata": {}, "cell_type": "markdown", "source": ["Para diferenciar os datasets ap\u00f3s a jun\u00e7\u00e3o, vamos incluir uma nova coluna em cada dataset. Este processo ser\u00e1 \u00fatil posteriormente."]}, {"metadata": {}, "cell_type": "code", "outputs": [], "execution_count": null, "source": ["titanic.train$TrainSet <- TRUE\n", "titanic.test$TrainSet <- FALSE"]}, {"metadata": {}, "cell_type": "code", "outputs": [], "execution_count": null, "source": ["titanic.full <- rbind(titanic.train, titanic.test)\n", "table(titanic.full$TrainSet)\n", "table(titanic.full$Survived, titanic.full$Sex)"]}, {"metadata": {}, "cell_type": "markdown", "source": ["Primeira etapa cumprida! \n", "Observem que existem 891 passageiros no dataset de treino e 418 passageiros no dataset de teste. Considerando que somente o dataset de treino traz informa\u00e7\u00f5es de sobreviventes, temos 233 sobreviventes mulheres e 109 homens. J\u00e1 podemos tirar as primeiras conclus\u00f5es, ou seja, h\u00e1 mais sobreviventes mulheres e existiam mais homens a bordo. Nossos pr\u00f3ximos passos consistem na **identifica\u00e7\u00e3o**, **tratamento** e **classifica\u00e7\u00e3o** de dados do dataset full. \n", "\n", "**<h2>Dinheiro faz diferen\u00e7a para sobreviver?</h2>**\n", "\n", "\u00c9 comum fazermos perguntas, ou seja, estamos diante de um problema e questionar auxilia na constru\u00e7\u00e3o de um roteiro de an\u00e1lise de dados. Nosso primeiro desafio \u00e9 responder a esta pergunta, neste caso, vamos observar a vari\u00e1vel *Fare* (Custo da passagem), portanto, vamos utilizar o c\u00f3digo abaixo para esta r\u00e1pida observa\u00e7\u00e3o."]}, {"metadata": {}, "cell_type": "code", "outputs": [], "execution_count": null, "source": ["boxplot(titanic.full$Fare)"]}, {"metadata": {}, "cell_type": "markdown", "source": ["\u00c9 poss\u00edvel notar que a grande maioria pagou uma tarifa menor que $70. Vamos utilizar outro comando que traz informa\u00e7\u00f5es detalhadas."]}, {"metadata": {}, "cell_type": "code", "outputs": [], "execution_count": null, "source": ["boxplot.stats(titanic.full$Fare)"]}, {"metadata": {}, "cell_type": "markdown", "source": ["A fun\u00e7\u00e3o *boxplot.stats()* retorna os valores extremos e quartis. Para saber mais, veja este link: https://pt.wikipedia.org/wiki/Diagrama_de_caixa\n", "\n", "Sabemos que existem tarifas distintas, portanto, para facilitar a observa\u00e7\u00e3o dos dados em um gr\u00e1fico, vamos considerar os dados contidos at\u00e9 o 3\u00ba quartil, ou seja, 75% dos passageiros que pagaram um valor menor ou igual a 65.\n", "\n", "**$stats**\n", "\n", "0 7.8958 14.4542 31.275 **65**"]}, {"metadata": {}, "cell_type": "code", "outputs": [], "execution_count": null, "source": ["fare.wirsker <- boxplot.stats(titanic.full$Fare)$stats[5]\n", "\n", "ggplot(data = titanic.train[titanic.train$Fare <= fare.wirsker,], aes(x = Fare, fill = factor(Survived))) +\n", "  geom_histogram() +\n", "  labs(x = 'Custo da Passagem', y = 'Total de Passageiros') +\n", "  facet_grid(.~Sex) + \n", "  theme_minimal()"]}, {"metadata": {}, "cell_type": "code", "outputs": [], "execution_count": null, "source": []}], "nbformat": 4, "nbformat_minor": 1}